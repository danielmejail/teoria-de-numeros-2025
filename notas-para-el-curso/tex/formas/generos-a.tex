\theoremstyle{plain}
\newtheorem{teoGeneros}{\teoname}[section]
\newtheorem{coroGeneros}[teoGeneros]{\coroname}
\newtheorem{lemaGeneros}[teoGeneros]{\lemaname}

\theoremstyle{definition}
\newtheorem{defGeneros}[teoGeneros]{\defname}
\newtheorem{ejemGeneros}[teoGeneros]{\ejemname}
\newtheorem{obsGeneros}[teoGeneros]{\obsname}

%-------------

% La relaci\'on de equivalencia refleja, talvez, un aspecto m\'as bien
% algebraico de las formas cuadr\'aticas.
En esta secci\'on, introduciremos la noci\'on de \emph{g\'enero}
de una forma cuadr\'atica (binaria, definida positiva y primitiva),
que nos permitir\'a subdividir las formas cuadr\'aticas
teniendo en cuenta sus propiedades de representaci\'on.
Sabemos que formas equivalentes representan los mismos enteros
(el conjunto de enteros representados es un invariante de la
clase de equivalencia de una forma).
Con lo cual, la subdivisi\'on del conjunto de formas de acuerdo con su
g\'enero terminar\'a siendo una subdivisi\'on m\'as gruesa que la
subdivisi\'on por clases de equivalencia o clases de equivalencia
estricta; cada g\'enero de formas cuadr\'aticas estar\'a conformado por
(posiblemente) varias clases de equivalencia.

El \teoname~\ref{teo:landau} nos muestra que, salvo muy pocos casos,
si queremos caracterizar los primos representados en la forma
$p=x^2+ny^2$, las ideas introducidas hasta esta parte no son suficientes.
Dado un discriminante $D$, el \teoname~\ref{teo:representaciones} nos
permite decidir si un primo $p$ es representado por \emph{alguna} forma de
discriminante $D$. M\'as aun, como toda forma es equivalente a una forma
reducida, podemos decidir si $p$ es representado por alguna forma reducida
de discriminante $D$.
Si el n\'umero de clases $\nClases(D)=1$, entonces la condici\'on
$\chi(p)=1$ es suficiente para saber cu\'al es dicha forma, pues hay,
en ese caso, una \'unica forma reducida; si $D=-4n$, dicha forma es
$\binaria{1,0,n}$.
Pero, cuando el n\'umero de clases $\nClases(D)>1$,
la condici\'on $\chi(p)=1$ no da informaci\'on acerca de cu\'al de todas
las formas reducidas (o cu\'ales) representan $p$.

\begin{ejemGeneros}\label{ejem:generos:menos-veinte}
	Hay dos clases de formas de discriminante $-20$.
	El argumento es similar al del \ejemname~\ref{ejem:reducidas}.
	Si $f=\binaria{a,b,c}$ es una forma cuadr\'atica primitiva,
	reducida y de discriminante $-20$, entonces
	$1\leq a\leq\sqrt{20/3}<7$, o sea $a\in\{1,2\}$. Adem\'as,
	como $D\equiv 0\tmodulo[4]$, debe ser $b\equiv 0\tmodulo[2]$. 
	Si $a=1$, entonces $b=0$ y $c=5$ es la \'unica posibilidad.
	Si $a=2$, entonces $b\in\{0,2\}$, pero $-20=b^2-4ac$ con
	$c\in\Enteros$ fuerza que $b=2$ y, as\'{\i}, $c=3$. O sea,
	$\nClases(-20)=2$ y las clases est\'an representadas por
	las formas primitivas reducidas
	\begin{displaymath}
		x^2\,+\,5y^2\dispand 2x^2\,+\,2xy\,+\,3y^2
		\dispstop
	\end{displaymath}
	%
	Por el \coroname~\ref{coro:reducidas:representaciones},
	un primo impar $p\neq 5$ est\'a representado por una
	forma reducida de discriminante $-20$, si y s\'olo si
	$\tlegendre{-5} p=1$. Pero
	\begin{displaymath}
		\tlegendre{-5} p\,=\,1\dispcomma\dispiff
		p\,\equiv\,1,9,7,3\tmodulo[20]
		\dispstop
	\end{displaymath}
	%
	En definitiva, un primo impar $p\neq 5$ es representado
	por una forma reducida de discriminante $-20$, si y s\'olo si
	\begin{displaymath}
		p\,\equiv\,1,9,7,3\tmodulo[20]
		\dispiff
		\left\{
			\begin{array}{l}
				p\,=\,x^2+5y^2\dispor \\
				p\,=\,2x^2+2xy+3y^2
				\dispstop
			\end{array}
		\right.
	\end{displaymath}
	%
	Hasta este punto, la teor\'{\i}a general no nos permite
	decidir si $p=x^2+5y^2$ o no.
	Ahora, si $p=x^2+5y^2$, entonces $p\equiv 1,4\tmodulo[5]$ y,
	en particular,
	\begin{displaymath}
		p \,\equiv\, 1,9\tmodulo[20]
			\dispiff p\,=\,x^2+5y^2
		\dispstop
	\end{displaymath}
	%
	An\'alogamente, si $\mcd{x,y}=1$, entonces
	$2x^2+2xy+3y^2\equiv 2,3\tmodulo[5]$, con lo que
	\begin{displaymath}
		p\,\equiv\,7,3\tmodulo[20]
			\dispiff p\,=\,2x^2+2xy+3y^2
		\dispstop
	\end{displaymath}
	%
\end{ejemGeneros}

\begin{ejemGeneros}\label{ejem:generos:menos-cincuenta-y-seis}
	Hay cuatro clases de formas de discriminante $-56$. Las formas
	reducidas correspondientes son
	\begin{displaymath}
		\binaria{1,0,14} \dispcomma\quad
		\binaria{2,0,7} \dispcomma\quad
		\binaria{3,-2,5} \dispand
		\binaria{3,2,5}
		\dispstop
	\end{displaymath}
	%
	Por el \coroname~\ref{coro:reducidas:representaciones},
	un primo impar $p\neq 7$ est\'a representado por alguna de estas
	formas cuadr\'aticas, si y s\'olo si $\tlegendre{-14} p=1$. Pero
	\quedacomoejercicio,
	% % PARA EL EXAMEN
	% % Explicar o mostrar mediante ejemplos el significado de la
	% % afirmaci\'on: ``no es posible, conociendo \'unicamente la clase
	% % de congruencia de $p$ m\'odulo $56$, determinar si $p$ es o no
	% % de la forma $x^2+14y^2$''.
	\begin{itemize}
		\item si $p=x^2+14y^2$ o $p=2x^2+7y^2$, entonces
			$p\equiv 1,7\tmodulo[8]$ y
			$p\equiv 1,2,4\tmodulo[7]$, y,
		\item si $p=3x^2\pm 2xy+5y^2$, entonces debe ser
			$p\equiv 3,5\tmodulo[8]$ y
			$p\equiv 3,5,6\tmodulo[7]$.
	\end{itemize}
	%
	La condici\'on m\'odulo $7$ la podemos deducir, por ejemplo, de la
	condici\'on m\'odulo $8$ y de que, por Reciprocidad cuadr\'atica,
	\begin{displaymath}
		\tlegendre{-14} p\,=\,\tlegendre{-7} p\tlegendre 2 p\,=\,
			\tlegendre p 7\tlegendre 2 p
		\dispstop
	\end{displaymath}
	%
	Notamos, adem\'as, que $\binaria{1,0,14}$ y $\binaria{2,0,7}$ ambas
	representan primos en todas las clases
	$p\equiv 1,25,9,15,39,23\tmodulo[56]$,
	y que $\binaria{3,\pm 2,5}$ representan exactamente los mismos
	enteros.
\end{ejemGeneros}

\begin{obsGeneros}\label{obs:generos:ejemplos}
	Fijado un discriminante $D$, la clase de congruencia de un primo
	$p$ m\'odulo $D$ nos permite decir, en primera instancia,
	si $p$ es representable por alguna forma de discriminante $D$.
	Como se ve en el \ejemname~\ref{ejem:generos:menos-veinte} y en
	el \ejemname~\ref{ejem:generos:menos-cincuenta-y-seis},
	por la clase de congruencia de $p$ tambi\'en podemos precisar
	mejor las formas que posiblemente lo representen; podemos eliminar
	formas que no lo pueden representar, de acuerdo con la clase
	de congruencia.
	En el \ejemname~\ref{ejem:generos:menos-veinte},
	podemos ver que la clase de congruencia de un primo $p$ m\'odulo $20$
	determina la forma reducida que lo representa.
	En el \ejemname~\ref{ejem:generos:menos-cincuenta-y-seis},
	no es posible distinguir exactamente cu\'al es la clase
	que lo representa. En particular, no podemos decir, dado
	$p\equiv 1,25,9,15,39,23\tmodulo[56]$, si $p$ es de la forma
	$x^2+14y^2$. M\'as aun, $p$ podr\'{\i}a estar % (y, de hecho, est\'a)
	representado por m\'as de una forma reducida.
	En definitiva, hay un l\'{\i}mite a lo que podemos deducir a partir
	de (estas) congruencias.
\end{obsGeneros}

% En la \defname~\ref{def:definiciones:representacion}, definimos lo que
% significa que una forma cuadr\'atica represente un entero: $f$ representa
% $m\in\Enteros$, si existen $x,y\in\Enteros$ tales que $f(x,y)=m$.
% Teniendo en cuenta la \obsname~\ref{obs:generos:ejemplos}, introducimos
% la siguiente variante de este concepto de representaci\'on.

\begin{defGeneros}\label{def:generos:representacion:mod}
	Dados $D\in\Enteros$, una clase de congruencia
	$c\in\Enterosmod[D]$ y una forma $f$, decimos que
	\emph{la clase $c$ es representada por $f$} (o que \emph{$f$ %
	representa la clase $c$}), si existe $m\in c$, perteneciente a la
	clase, tal que $m$ es representado por $f$.
\end{defGeneros}

\begin{ejemGeneros}\label{ejem:generos:representacion:mod}
	La forma $\binaria{1,0,14}$ representa las clases
	\begin{displaymath}
		\clase 1\dispcomma\quad
		\clase{25}\dispcomma\quad
		\clase 9\dispcomma\quad
		\clase{15}\dispcomma\quad
		\clase{39}\dispand
		\clase{23}
	\end{displaymath}
	%
	m\'odulo $56$, porque, por ejemplo, representa \emph{los enteros}
	$1$, $25$, $9$, $15$, $39$ y $23$. Sin embargo, la forma
	$\binaria{2,0,7}$ tambi\'en representa estas clases:
	representa
	\begin{displaymath}
		9\,=\,2\cdot 1^2+7\dispcomma\quad
		15\,=\,2\cdot 2^2+7\dispcomma\quad
		25\,=\,2\cdot 3^2+7\dispand
		39\,=\,2\cdot 4^2+7
		\text{ ;}
	\end{displaymath}
	%
	pero tambi\'en representa
	\begin{displaymath}
		57\,=\,2\cdot 5^2+7\,\equiv\,1\modulo[56]
		\dispand
		79\,=\,2\cdot 6^2+7\,\equiv\,23\modulo[56]
		\dispstop
	\end{displaymath}
	%
\end{ejemGeneros}

% De la teor\'{\i}a desarrollada en la \S~\ref{sec:representaciones}, sabemos
% que formas equivalentes representan los mismos enteros.

% \begin{defGeneros}\label{def:generos:clases-coprimas}
	% Dados $D\in\Enteros$ y una clase $c\in\Enterosmod[D]$, decimos
	% que \emph{$c$ es coprima con $D$}, si los enteros de la clase
	% $c$ son coprimos con $D$.
% \end{defGeneros}
% 
% \begin{obsGeneros}\label{obs:generos:clases-coprimas}
	% Si $m\equiv n\tmodulo[D]$, entonces $\mcd{m,D}=\mcd{n,D}$.
	% En particular, cuando $m\equiv n$, $m$ es coprimo con $D$, si
	% y s\'olo si $n$ lo es. En consecuencia,
	% si $D\in\Enteros$ y $c\in\Enterosmod[D]$, entonces $c$ es coprima
	% con $D$, si y s\'olo si \emph{al menos uno de los enteros %
	% pertenecientes a $c$} es coprimo con $D$.
% \end{obsGeneros}
% 
% Las clases de congruencia coprimas con $D$ son aquellas
% pertenecientes a $\Unidadesmod[D]$.

\begin{defGeneros}\label{def:generos}
	Dos formas cuadr\'aticas % \emph{primitivas} definidas positivas
	de discriminante $D$ \emph{pertenecen al mismo g\'enero},
	si representan las mismas clases
	% coprimas con $D$.
	% % es decir, las mismas clases
	en $\Unidadesmod[D]$.
\end{defGeneros}

\begin{ejemGeneros}\label{ejem:generos}
	Para $D=-20$, hay dos formas reducidas y, por lo tanto, dos
	clases de formas de discriminante $-20$. De acuerdo con el
	\ejemname~\ref{ejem:generos:menos-veinte},
	las dos formas reducidas no pertenecen al mismo g\'enero.
	En particular, en este caso, el g\'enero de una forma coincide
	con su clase de equivalencia (estricta).
	Las clases de congruencia m\'odulo $20$ tambi\'en se dividen
	en dos, aquellas representadas por $\binaria{1,0,5}$ y aquellas
	representadas por $\binaria{2,2,3}$:
	\begin{displaymath}
		\big\{1,\,9\big\}\dispand
		\big\{7,3\big\}
		\dispstop
	\end{displaymath}
	%

	Para $D=-56$, sin embargo, encontramos cuatro clases de formas
	cuadr\'aticas de discriminante $-56$;
	hay cuatro formas reducidas. De acuerdo con el
	\ejemname~\ref{ejem:generos:menos-cincuenta-y-seis},
	las formas se agrupan en dos g\'eneros:
	\begin{displaymath}
		\big\{
			\binaria{1,0,14},\,
			\binaria{2,0,7}
		\big\}\dispand
		\big\{
			\binaria{3,-2,5},\,
			\binaria{3,2,5}
		\big\}
		\dispstop
	\end{displaymath}
	%
	Las clases de congruencia m\'odulo $56$ se dividen en dos,
	aquellas representadas por uno y otro g\'enero:
	\begin{displaymath}
		\big\{1,\,25,\,9,\,15,\,39,\,23\big\}\dispand
		\big\{3,\,19,\,27,\,45,\,5,\,13\big\}
		\dispstop
	\end{displaymath}
	%
\end{ejemGeneros}

% \begin{obsGeneros}\label{obs:generos}
	% Con la \defname~\ref{def:generos}, parece que estamos
	% dejando de lado el problema de representar primos por formas
	% cuadr\'aticas, porque, en lugar de responder qu\'e primos
	% representa cada una de las formas reducidas, el g\'enero de una
	% forma parece responder qu\'e clases de congruencia m\'odulo
	% el discriminante representa dicha forma;
	% en particular, pareciera que nos hemos 	olvidado del problema
	% de clasificar primos de la forma $p=x^2+ny^2$.
	% Sin embargo, en los ejemplos, nos hemos restringido a n\'umeros
	% primos y sus clases de congruencia m\'odulo el discriminante
	% para, en primer lugar, saber si la clase distinguir los g\'eneros.
	% %% HACER EL ESQUEMA COMPARANDO LAS DISTINTAS SUBDIVISIONES EN
	% %% EL CONJUNTO DE FORMAS
	% El siguiente diagrama muestra distintos criterios para
	% subdividir el conjunto de formas cuadr\'aticas (primitivas)
	% de discriminante $D$:
	% \begin{center}
		% \begin{tikzcd}[column sep=small]%-3ex]
			% % &
			% \left\{
				% \text{formas cuadr\'aticas}
			% \right\} \arrow[d] & \\
			% % &
			% \left\{\begin{matrix}
				% \text{clases de} \\
				% \text{equivalencia estricta}
			% \end{matrix}\right\} \arrow[d]
				% \arrow[u, bend right=40, %
					% end anchor={[xshift=1ex]}, dashed] & \\
			% % &
			% \left\{\begin{matrix}
				% \text{clases de} \\
				% \text{equivalencia}
			% \end{matrix}\right\} \arrow[d] & \\
			% % \big\{m=f(x,y)\,:\,x,y\in\Enteros\big\} &
			% \left\{\begin{matrix}
				% \text{(enteros\phantom)} \\
				% \text{\phantom(representados)}
			% \end{matrix}\right\} \arrow[d] \arrow[r] &
			% \left\{\begin{matrix}
				% \text{(primos\phantom)} \\
				% \text{\phantom(representados)}
			% \end{matrix}\right\} \arrow[d] \\
			% % \big\{p=f(x,y)\,:\,x,y\in\Enteros\big\} &
			% \left\{\begin{matrix}
				% \text{(clases de\phantom)} \\
				% \text{congruencia m\'odulo } D \\
				% \text{\phantom(de enteros representados)}
			% \end{matrix}\right\} \arrow[r, equals] &
			% \left\{\begin{matrix}
				% \text{(clases de\phantom)} \\
				% \text{congruencia m\'odulo } D \\
				% \text{\phantom(de primos representados)}
			% \end{matrix}\right\}
		% \end{tikzcd}
		% %
		% \dispstop
	% \end{center}
	% %
	% La direcci\'on de las flechas indica criterios cada vez menos
	% restrictivos (salvo por la flecha punteada). Podemos agrupar
	% formas usando la relaci\'on de equivalencia estricta.
	% A cada forma le corresponde una \'unica forma reducida.
	% Y, en cada clase, podemos elegir la forma reducida como
	% representante can\'onico de la misma.
	% Formas equivalentes representan los mismos enteros;
	% esencialmente, dos formas son equivalentes, si una se obtiene
	% a partir de la otra mediante un cambio de variables (sobre
	% $\Enteros$).
	% El criterio de agrupar formas de acuerdo a clases de congruencia
	% de enteros representados es, precisamente, la noci\'on de g\'enero.
% 
	% Ahora, dado que nuestro inter\'es en formas cuadr\'aticas
	% ven\'{\i}a del problema de la representabilidad de primos
	% por formas cuadr\'aticas (precisamente por las formas
	% $x^2+ny^2$), tiene sentido mirar \'unicamente qu\'e primos
	% representa cada forma y juntar aquellas que representan los
	% mismos primos.
	% Pero la representabilidad de un primo por alguna forma de
	% discriminante $D$ est\'a determinada por su clase de congruencia
	% m\'odulo $D$.
	% Si, siguiendo con la idea de los ejemplos de determinar, para
	% cada forma $f$ de discriminante $D$ y cada representaci\'on
	% $p=f(x,y)$ de un n\'umero primo (impar y que no divida a $D$),
	% la posible clase de congruencia de $p$ m\'odulo $D$,
% \end{obsGeneros}
% 
