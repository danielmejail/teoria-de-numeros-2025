\theoremstyle{plain}
\newtheorem{teoGenerosB}{\teoname}[section]
\newtheorem{lemaGenerosB}[teoGenerosB]{\lemaname}
\newtheorem{coroGenerosB}[teoGenerosB]{\coroname}

\theoremstyle{definition}
\newtheorem{obsGenerosB}[teoGenerosB]{\obsname}
\newtheorem{defGenerosB}[teoGenerosB]{\defname}

%-------------

\begin{obsGenerosB}\label{obs:generos:representacion}
	Sea $D\equiv 0,1\tmodulo[4]$, $D<0$, y sean $f,g$ formas
	de discriminante $D$ pertenecientes al mismo g\'enero.
	Si $c\in\Unidadesmod[D]$ es representada por $f$, entonces
	es representada por $g$. Dicho de otra manera, si
	$m\in c$ y $m=f(x,y)$ para ciertos $x,y\in\Enteros$, entonces
	existen $n\in c$ y $x',y'\in\Enteros$ tales que
	$n=g(x',y')$.
\end{obsGenerosB}

\begin{defGenerosB}\label{def:generos:representacion}
	Sea $D\equiv 0,1\tmodulo[4]$, $D<0$, y sea $f$ una forma
	de discriminante $D$. Si $c\in\Unidadesmod[D]$ es
	representada por $f$, decimos tambi\'en que
	\emph{la clase $c$ es representada por el g\'enero de $f$}.
\end{defGenerosB}

\begin{defGenerosB}\label{def:generos:principal}
	Sea $D\equiv 0,1\tmodulo[4]$, $D<0$. Llamamos
	\emph{forma principal (de discriminante $D$)} a la forma
	\begin{itemize}
		\item $\binaria{1,0,-D/4}$, si $D\equiv 0$, y a la forma
		\item $\binaria{1,1,(1-D)/4}$, si $D\equiv 1$.
	\end{itemize}
	%
	El \emph{g\'enero principal (de discriminante $D$)} es el
	g\'enero al que pertenece la forma principal.
\end{defGenerosB}

\begin{obsGenerosB}\label{obs:generos:principal}
	Dado un discriminante, la forma principal de dicho discriminante
	es una forma primitiva reducida.
\end{obsGenerosB}

\begin{restatable}{lemaGenerosB}{lemaGenerosBCoclases}
	\label{lema:generos}
	Sea $D\equiv 0,1\tmodulo[4]$, $D<0$, y sea $f$ una forma
	de discriminante $D$. Entonces,
	\begin{enumerate}[(i)]
		\item\label{item:lema:generos:principal}
			los valores en $\Unidadesmod[D]$ representados por
			el g\'enero principal constituyen un subgrupo
			$H\subgrpeq\ker(\chi)$;
		\item\label{item:lema:generos:coclases}
			los valores en $\Unidadesmod[D]$ representados por
			el g\'enero de $f$ constituyen una coclase de $H$
			en $\ker(\chi)$.
	\end{enumerate}
	%
\end{restatable}

\begin{teoGenerosB}\label{teo:generos}
	Sea $D\equiv 0,1\tmodulo[4]$, $D<0$, y sea $H\subgrpeq\ker(\chi)$
	como en el \lemaname~\ref{lema:generos}. Si $H'\subset\ker(\chi)$
	es una coclase de $H$ en $\ker(\chi)$ y $p$ es un primo impar
	que no divide a $D$, entonces su clase de congruencia
	$\clase p\in H'$, si y s\'olo si $p$ es representado por una forma
	de discriminante $D$ perteneciente al g\'enero correspondiente a $H'$.
\end{teoGenerosB}

\begin{obsGenerosB}\label{obs:generos:correspondencia}
	Dada una coclase $H'$ de $H$ en $\ker(\chi)$, las clases de
	congruencia contenidas en $H'$ son representadas por formas
	de discriminante $D$ (pues $H'\subset\ker(\chi)$; ver el
	\coroname~\ref{coro:dirichlet}).
	Dada una forma (primitiva) de discriminante $D$, $f$,
	las clases en $\Unidadesmod[D]$ representadas por $f$
	constituyen una coclase de $H$ en $\ker(\chi)$
	(\lemaname~\ref{lema:generos}~\eqref{item:lema:generos:coclases}).
	Existe, entonces, una biyecci\'on
	\begin{displaymath}
		\big(
			\text{coclases de }
			H\text{ en }\ker(\chi)
		\big)\,\simeq\,
		\big(
			\text{g\'eneros de formas primitivas %
				de discriminante } D
		\big)
	\end{displaymath}
	%
	dada por asignar, a una forma (primitiva de discriminante $D$) $f$,
	el conjunto de enteros que ella representa
	% y, luego, las clases de congruencia m\'odulo $D$
	y, a cada entero $m$ coprimo con $D$, el conjunto de formas
	(primitivas de discriminante $D$) que lo representan.
	% y, luego, el g\'enero al cual estas formas pertenecen
\end{obsGenerosB}

\begin{proof}[\proofname~del \lemaname~\ref{lema:generos}]
	La demostraci\'on estar\'a dividida en cuatro partes:
	\begin{enumerate}[1]
		\item\label{item:lema:generos:nucleo}
			si $m\in\Enteros$, $\mcd{m,D}=1$, es tal que
			$m=f(x,y)$ para alguna forma $f$ de discriminante
			$D$, entonces $\clase m\in\ker(\chi)$;
			% no asumimos que $m$ sea propiamente representado,
			% ni que $f$ sea primitiva
		\item\label{item:lema:generos:subgrupo}
			si $H\subset\ker(\chi)$ denota el subconjunto de
			clases de congruencia m\'odulo $D$ representadas
			en el g\'enero principal,
			entonces $H$ es un subgrupo de $\ker(\chi)$;
			% no asumimos que los elementos de $H$ sean
			% propiamente representados en el g\'enero
			% principal
		\item\label{item:lema:generos:primitivas}
			si $f$ es una forma \emph{primitiva} de discriminante
			$D$ y $M\in\Enteros$, entonces existe, al menos,
			un $k\in\Enteros$, $\mcd{k,M}=1$, propiamente
			representado por $f$;
		\item\label{item:lema:generos:coclases}
			si $f$ es una forma primitiva de discriminante $D$,
			entonces los valores en $\Unidadesmod[D]$
			representados por $f$ constituyen una coclase de
			$H$ en $\ker(\chi)$.
	\end{enumerate}
	%

	\begin{proof}[\proofname~de~\ref{item:lema:generos:nucleo}]
		Si $m=f(x,y)$ y $g=\mcd{x,y}$, entonces $g^2\mid m$ y
		\begin{displaymath}
			f(x/g,y/g)\,=\,m/g^2
		\end{displaymath}
		%
		es una representaci\'on propia de $m'=m/g^2$ por $f$.
		Dado que $\chi$ es \emph{multiplicativo} y
		\emph{cuadr\'atico},%
		\footnote{
			``Multiplicativo'' quiere decir
			$\chi(x\,y)=\chi(x)\,\chi(y)$, para todo par
			$x,y\in\Enteros$,
			``cuadr\'atico'' quiere decir que
			$\chi(x)^2=1$ para todo $x\in\Enteros$,
			o sea, $\chi(x)\in\{\pm 1\}$.
		}
		\begin{displaymath}
			\chi(m')\,=\,\chi(m)
			\dispcomma
		\end{displaymath}
		%
		as\'{\i} que podemos suponer que $m$ es representado
		propiamente por $f$. Ahora, separamos en dos casos.
		Si $m$ es impar, por el \lemaname~%
		\ref{lema:representaciones:primitiva}, existe
		$\beta\in\Enteros$ tal que $D\equiv\beta^2\tmodulo[m]$.
		Entonces, en este caso,
		\begin{displaymath}
			\chi(m)\,=\,\legendre D m\,=\,
				\legendre{\beta^2} m\,=\,
				\legendre \beta m^2\,=\,1
			\dispstop
		\end{displaymath}
		%
		Es decir, $\clase m\in\ker(\chi)$.
		Si, en cambio, $m$ es par, entonces afirmamos:
		\begin{enumerate}[{.}1]
			\item\label{item:lema:generos:nucleo:i}
				el discriminante es $D\equiv 1\tmodulo[8]$;
			\item\label{item:lema:generos:nucleo:ii}
				la clase $\clase m\in\ker(\chi)$.
		\end{enumerate}
		%
		En cuanto a {.\ref{item:lema:generos:nucleo:i}},
		si una forma $f$ de discriminante $D$ representa un
		n\'umero par $m$, entonces $f$ es equivalente a
		$mx^2+Bxy+Cy^2$ y $D=B^2-4mC\equiv B^2\tmodulo[8]$.
		Como $D\equiv 1\tmodulo[4]$, se deduce que
		$D\equiv 1\tmodulo[8]$ (es impar).
		En cuanto a \label{item:lema:generos:nucleo:ii},
		como $D\equiv 1\tmodulo[8]$, se cumple que
		\begin{displaymath}
			\chi(2)\,=\,1
			\dispstop
		\end{displaymath}
		%
		Entonces, si $m=2^r m'$ con $m'$ impar, vale que
		\begin{displaymath}
			\chi(m)\,=\,\chi(m')
			\dispstop
		\end{displaymath}
		%
		Pero $D\equiv\beta^2\tmodulo[m]$ implica
		$D\equiv\beta^2\tmodulo[m']$. Como $m'$ es impar,
		\begin{displaymath}
			\chi(m')\,=\,\legendre D{m'}\,=\,
				\legendre \beta{m'}^2\,=\,1
			\dispstop
		\end{displaymath}
		%
		% podemos concluir de esto que $m'$ es representado
		% (propiamente) por una forma (primitiva) de
		% discriminante $D$, pero no lo necesitamos
	\end{proof}

	\begin{proof}[\proofname~de~\ref{item:lema:generos:subgrupo}]
		Por la parte~\ref{item:lema:generos:nucleo}, sabemos que
		$H\subset\ker(\chi)$. Veamos que es subgrupo. Si $D=-4n$,
		la forma principal es $\binaria{1,0,n}$ y, por el
		\ejername~\ref{ejer:fermat:identidades}~%
		\eqref{item:ejer:fermat:identidades},
		el subconjunto $H$ es cerrado por multiplicaci\'on:
		si $m,m'\in H$, entonces $mm'\in H$. Ahora, como
		$\ker(\chi)$ ($\Unidadesmod[D]$) es un grupo finito
		(de torsi\'on), $H$ es un subgrupo.
		Si $D\equiv 1\tmodulo[4]$, la forma principal es
		$f_0:=\binaria{1,1,(1-D)/4}$, entonces
		\begin{displaymath}
			4\,f_0(x,y)\,=\,(2x+y)^2-Dy^2\,\equiv\,
				(2x+y)^2\tmodulo[D]
			\dispstop
		\end{displaymath}
		%
		En consecuencia, en este caso, $H$ est\'a contenido en
		el \emph{subgrupo} de cuadrados m\'odulo $D$
		(pues $D$ es impar y $2\in\Unidadesmod[D]$).
		Rec\'{\i}procamente, si $\beta\in\Enteros$,
		\begin{displaymath}
			4\,f(\beta,0)\,=\,4\,f(0,2\beta)\,\equiv\,
				4\,\beta^2\tmodulo[D]
			\dispstop
		\end{displaymath}
		%
		Dado que $\mcd{4,D}=1$, $f_0$ representa la clase de
		$\beta$ en $\Unidadesmod[D]$. Entonces, en este caso
		tambi\'en, $H$ es un subgrupo de $\Unidadesmod[D]$ y,
		m\'as precisamente, es el subgurpo de cuadrados
		en $\Unidadesmod[D]$.
	\end{proof}

	\begin{proof}[\proofname~de~\ref{item:lema:generos:primitivas}]
		Sea $f=\binaria{a,b,c}$ una forma \emph{primitiva}
		y sea $p$ un n\'umero primo. Podemos recuperar los
		coeficientes de la forma evaluando en ciertos puntos:
		\begin{displaymath}
			f(1,0)\,=\,a\dispcomma\quad
			f(0,1)\,=\,c\dispand
			f(1,1)\,=\,a+b+c
			\dispstop
		\end{displaymath}
		%
		Como estamos asumiendo que $f$ es primitiva, el primo
		escogido $p$ no puede dividir estos tres valores
		simult\'aneamente. Obtenemos, de esta manera,
		\emph{alg\'un} entero no divisible por $p$ y propiamente
		representado por $f$.
		Si, ahora, $M\in\Enteros$ (arbitrario), podemos elegir,
		para cada primo $p\mid M$, un $k_p\in\Enteros$ no divisible
		por $p$ y propiamente representado por $f$, es decir,
		existen $k_p$, $x_p$, $y_p$ tales que
		\begin{displaymath}
			k_p\,=\,f(x_p,y_p)\dispcomma\quad
			p\nmid k_p\dispand
			\mcd{x_p,y_p}\,=\,1
			\dispstop
		\end{displaymath}
		%
		Por el Teorema chino del resto, existen $x,y\in\Enteros$
		tales que
		\begin{displaymath}
			x\,\equiv\,x_p\tmodulo[p]
			\dispand
			y\,\equiv\,y_p\tmodulo[p]
		\end{displaymath}
		%
		para cada primo $p\mid M$. Si $k:=f(x,y)$, entonces
		$k\equiv k_p\tmodulo[p]$ y, por lo tanto,
		$p$ no divide a $k$ y $\mcd{k,M}=1$.
		Si $g:=\mcd{x,y}\geq 1$, dividiendo por $g^2$ a $x$ y a $y$,
		el entero $k/g^2$ es coprimo con $M$ y propiamente
		representado por $f$.
	\end{proof}

	\begin{proof}[\proofname~de~\ref{item:lema:generos:coclases}]
		Supongamos, en primer lugar, que $D\equiv 0\tmodulo[4]$,
		$D=-4n$, $n>0$. Elegimos $M=4n$. Si $f$ es una forma
		primitiva discriminante $D$, podemos, por la parte
		\ref{item:lema:generos:primitivas}, encontrar $a\in\Enteros$,
		$\mcd{a,M}=1$, propiamente representado por $f$.
		Por el \lemaname~\ref{lema:representaciones:propiamente},
		la forma $f$ es estrictamente equivalente a una forma
		$f_1=\binaria{a,b,c}$ (con $a$ como primer coeficiente).
		Dado que $f$ y $f_1$ representan los mismos enteros,
		podemos asumir que la forma $f$ es $f=\binaria{a,b,c}$,
		con $\mcd{a,4n}=1$. Asumiendo esto, vemos que
		\begin{displaymath}
			\begin{aligned}
				-4n & \,=\,b^2-4ac \dispcomma \\
				b & \,=\,2b' \quad\text{es par y} \\
				af(x,y) & \,=\,(ax+b'y)^2+ny^2
				% a^2x^2+2ab'xy+acy^2
					% \,=\,(ax)^2+2(ax)(b'y)+({b'}^2+n)y^2
				\,\in\,H
				\dispstop
			\end{aligned}
			%
		\end{displaymath}
		%
		En particular, los valores en $\Unidadesmod[D]$ representados
		por $f$ pertenecen a la coclase $\clase a^{-1}H$.
		Rec\'{\i}procamente, dada $\clase c\in\clase a^{-1}H$,
		para ciertos $z,w\in\Enteros$, se cumple
		\begin{displaymath}
			ac\,\equiv\,z^2+nw^2\modulo[4n]
		\end{displaymath}
		%
		\quedacomoejercicio.
		Sean $x,y\in\Enteros$ tales que
		\begin{displaymath}
			ax+b'y\,\equiv\,z\tmodulo[4n]
			\dispand
			y\,\equiv\,w\tmodulo[4n]
		\end{displaymath}
		%
		\quedacomoejercicio.
		% \hint{
			% $a$ es inversible m\'odulo $D=4n$.
		% }
		Entonces, $af(x,y)\equiv z^2+nw^2\equiv ac$ y
		$f(x,y)\equiv c\tmodulo[4n]$.

		Si $D\equiv 1\tmodulo[4]$, al igual que antes, podemos
		encontrar $a$ coprimo con $|D|$ propiamente representado
		por $f$ y cambiar $f$ por una forma estrictamente
		equivalente $\binaria{a,b,c}$. Asumiendo que
		$f=\binaria{a,b,c}$ con $\mcd{a,D}=1$,
		\begin{displaymath}
			4af(x,y)\,=\,(2ax+by)^2-Dy^2\,\equiv\,
				(2ax+by)^2\modulo[D]
			\dispstop
		\end{displaymath}
		%
		Dado que $\mcd{4,D}=1$ y tambi\'en $\mcd{a,D}=1$,
		\begin{displaymath}
			f(x,y)\,\equiv\,\clase a^{-1}\big(
				\clase 2^{-1}(2ax+by)\big)^2
				\,\in\,\clase a^{-1}H
			\dispstop
		\end{displaymath}
		%
		Rec\'{\i}procamente, dada $\clase c\in\clase a^{-1}H$,
		\begin{displaymath}
			4ac\,\equiv\,4\beta^2\,\equiv\,
				4\bigg(z^2+zw+\frac{1-D} 4\,w^2\bigg)
				\,\equiv\,(2z+w)^2\modulo[D]
		\end{displaymath}
		%
		\quedacomoejercicio.
		Eligiendo $x,y\in\Enteros$, tales que
		\begin{displaymath}
			2ax+by\,\equiv\,2z+w\modulo[D]
		\end{displaymath}
		%
		\quedacomoejercicio,
		vemos que $4af(x,y)\,\equiv\,4ac\tmodulo[D]$ y
		$f(x,y)\equiv c\tmodulo[D]$.
	\end{proof}
\end{proof}

\begin{restatable}{coroGenerosB}{coroGenerosBDescenso}
	\label{coro:generos:cero}
	Sea $n\in\Enteros$, $n>0$, y sea $p$ un primo impar que no
	divide a $n$. Entonces, $p$ es representado en una forma de
	discriminante $-4n$ perteneciente al g\'enero principal, si
	y s\'olo si existe $\beta\in\Enteros$ tal que
	\begin{displaymath}
		p\,\equiv\,\beta^2\dispor\beta^2+n\modulo[4n]
		\dispstop
	\end{displaymath}
	%
\end{restatable}

\begin{proof}
	Si $p$ es representada en una forma perteneciente al g\'enero
	principal, entonces
	\begin{displaymath}
		p\,\equiv\,x^2+ny^2\tmodulo[4n]
		\dispcomma
	\end{displaymath}
	%
	para ciertos $x,y\in\Enteros$.
	Si $y\equiv 0\tmodulo[2]$, entonces $p\equiv x^2\tmodulo[4n]$;
	si $y\equiv 1\tmodulo[2]$, entonces $p\equiv x^2+n\tmodulo[4n]$.
	Rec\'{\i}procamente, si $p$ es de esta forma, entonces $p$,
	su clase de congruencia, pertenece al subconjunto (subgrupo)
	de $\Unidadesmod[4n]$ de valores representados en la forma
	principal y, por lo tanto, en el g\'enero principal.
\end{proof}

El \coroname~\ref{coro:generos:cero} tiene una versi\'on para $D\equiv 1$.

\begin{coroGenerosB}\label{coro:generos:uno}
	Sea $D\equiv 1\tmodulo[4]$, $D<0$, y sea $p$ un primo impar
	que no divide a $D$. Entonces, $p$ es representado en una
	forma de discriminante $D$ perteneciente al g\'enero principal,
	si y s\'olo si $p$ es un cuadrado m\'odulo $|D|$.
\end{coroGenerosB}

\begin{proof}
	Si $p$ es representado en una forma del g\'enero principal,
	entonces
	\begin{displaymath}
		p\,\equiv\,x^2+xy+\frac{1-D} 4\,y^2
			\,\equiv\,\big(\clase 2^{-1}\,(2x+y)\big)^2
			\tmodulo[|D|]
		\dispstop
	\end{displaymath}
	%
	Rec\'{\i}procamente, si $p\equiv\beta^2\tmodulo[|D|]$,
	entonces $p$, su clase de congruencia,
	pertenece al subconjunto (subgrupo) de $\Unidadesmod[D]$
	de valores representados por la forma principal
	($x=\beta$, $y=0$) y, por lo tanto, por el g\'enero principal.
\end{proof}

\subsection*{Ejercicios}
\input{./tex/formas/ejercicios-generos-b.tex}

